

add_subdirectory("json")
SET(CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} -fPIC --static  -DEDS_VERBOSE")
SET(CMAKE_C_FLAGS  "${CMAKE_C_FLAGS} --static -DEDS_VERBOSE")
set(LANGUAGE C_STANDARD)



#add_executable(Edscorbot_SimTest src_test/simulated_server.cpp)
#target_include_directories(Edscorbot_SimTest PUBLIC "src_test" "./" "json/single_include/" "mosquitto/include/")
#TARGET_LINK_LIBRARIES(Edscorbot_SimTest PRIVATE  "${CMAKE_CURRENT_SOURCE_DIR}/lib/libmosquitto_static.a" -lpthread)
#target_link_libraries(Edscorbot_SimTest ${catkin_LIBRARIES})


SET(CMAKE_BUILD_TYPE "Debug")


cd ../
git clone https://github.com/eclipse/mosquitto >> script_log.txt
git clone https://github.com/nlohmann/json/ >> script_log.txt
cd mosquitto >> script_log.txt
rm -rf build >> script_log.txt
mkdir build >> script_log.txt
cd build >> script_log.txt
cmake .. -DWITH_STATIC_LIBRARIES=ON -DWITH_PIC=ON -DWITH_TLS=OFF -DDOCUMENTATION=OFF >> script_log.txt
make -j4 >> script_log.txt

ls -l lib >> script_log.txt
mkdir ../../lib >> script_log.txt
cp lib/libmosquitto_static.a ../../lib/libmosquitto_static.a >> script_log.txt